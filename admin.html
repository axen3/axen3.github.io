<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Game Admin Panel</title>
  <style>
    :root {
      /* Light theme variables */
      --bg-color: #f7fafc;
      --container-bg: #ffffff;
      --text-color: #2d3748;
      --secondary-text: #4a5568;
      --border-color: #e2e8f0;
      --card-bg: #ffffff;
      --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      --card-hover-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
      --input-focus: #3182ce;
      --button-bg: #3182ce;
      --button-hover: #2b6cb0;
      --add-game-bg: #805ad5;
      --add-game-hover: #6b46c1;
      --clear-btn-bg: #718096;
      --clear-btn-hover: #5a6268;
      --download-btn-bg: #38a169;
      --download-btn-hover: #2f855a;
      --upload-internet-bg: #ed8936;
      --upload-internet-hover: #dd6b20;
      --copy-btn-bg: #319795;
      --copy-btn-hover: #2c7a7b;
      --file-upload-border: #3182ce;
      --file-upload-label-bg: #3182ce;
      --file-upload-label-hover: #2b6cb0;
      --edit-btn-bg: #ecc94b;
      --edit-btn-hover: #d69e2e;
      --remove-btn-bg: #e53e3e;
      --remove-btn-hover: #c53030;
      --move-btn-bg: #38a169;
      --move-btn-hover: #2f855a;
      --pagination-active-bg: #38a169;
      --pagination-active-hover: #2f855a;
    }

    [data-theme="dark"] {
      /* Dark theme variables */
      --bg-color: #1a202c;
      --container-bg: #2d3748;
      --text-color: #e2e8f0;
      --secondary-text: #a0aec0;
      --border-color: #4a5568;
      --card-bg: #2d3748;
      --card-shadow: 0 4px 12px rgba(255, 255, 255, 0.05);
      --card-hover-shadow: 0 6px 16px rgba(255, 255, 255, 0.1);
      --input-focus: #63b3ed;
      --button-bg: #63b3ed;
      --button-hover: #4299e1;
      --add-game-bg: #9f7aea;
      --add-game-hover: #7f9cf5;
      --clear-btn-bg: #718096;
      --clear-btn-hover: #5a6268;
      --download-btn-bg: #38a169;
      --download-btn-hover: #2f855a;
      --upload-internet-bg: #ed8936;
      --upload-internet-hover: #dd6b20;
      --copy-btn-bg: #319795;
      --copy-btn-hover: #2c7a7b;
      --file-upload-border: #63b3ed;
      --file-upload-label-bg: #63b3ed;
      --file-upload-label-hover: #4299e1;
      --edit-btn-bg: #d69e2e;
      --edit-btn-hover: #b7791f;
      --remove-btn-bg: #e53e3e;
      --remove-btn-hover: #c53030;
      --move-btn-bg: #38a169;
      --move-btn-hover: #2f855a;
      --pagination-active-bg: #38a169;
      --pagination-active-hover: #2f855a;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-color);
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      color: var(--text-color);
      transition: background 0.3s, color 0.3s;
    }

    .container {
      max-width: 800px;
      width: 100%;
      background: var(--container-bg);
      border-radius: 12px;
      padding: 24px;
      box-shadow: var(--card-shadow);
      box-sizing: border-box;
      margin-bottom: 20px;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
    }

    h1 {
      color: var(--text-color);
      margin: 0;
      font-size: 24px;
      font-weight: 600;
    }

    .form-group {
      margin-bottom: 16px;
      width: 100%;
      box-sizing: border-box;
    }

    label {
      display: block;
      font-weight: 500;
      margin-bottom: 6px;
      color: var(--secondary-text);
    }

    input,
    textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 14px;
      transition: border-color 0.3s, background 0.3s;
      box-sizing: border-box;
      background: var(--container-bg);
      color: var(--text-color);
    }

    input:focus,
    textarea:focus {
      border-color: var(--input-focus);
      outline: none;
    }

    input:disabled {
      background: var(--border-color);
      color: var(--secondary-text);
      cursor: not-allowed;
    }

    button {
      width: 100%;
      padding: 12px;
      background: var(--button-bg);
      color: white;
      font-size: 14px;
      font-weight: 500;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
    }

    button:hover {
      background: var(--button-hover);
      transform: translateY(-1px);
    }

    .button-row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }

    #addGameBtn {
      background: var(--add-game-bg);
    }

    #addGameBtn:hover {
      background: var(--add-game-hover);
    }

    #clearBtn {
      background: var(--clear-btn-bg);
    }

    #clearBtn:hover {
      background: var(--clear-btn-hover);
    }

    #downloadBtn {
      background: var(--download-btn-bg);
      margin-bottom: 12px;
    }

    #downloadBtn:hover {
      background: var(--download-btn-hover);
    }

    #uploadInternetBtn {
      background: var(--upload-internet-bg);
      margin-bottom: 12px;
    }

    #uploadInternetBtn:hover {
      background: var(--upload-internet-hover);
    }

    .file-upload {
      position: relative;
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      margin: 12px 0;
      border: 1px solid var(--file-upload-border);
      border-radius: 6px;
      padding: 4px;
    }

    .file-upload input[type="file"] {
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }

    .file-upload label {
      background: var(--file-upload-label-bg);
      color: white;
      padding: 8px 16px;
      margin: 0;
      border-radius: 6px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.3s;
    }

    .file-upload label:hover {
      background: var(--file-upload-label-hover);
    }

    .file-upload span {
      font-size: 14px;
      color: var(--secondary-text);
    }

    #copyBtn {
      background: var(--copy-btn-bg);
    }

    #copyBtn:hover {
      background: var(--copy-btn-hover);
    }

    #gameCount {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-color);
      background: var(--container-bg);
      border-left: 4px solid var(--input-focus);
      padding: 8px 16px;
      border-radius: 6px;
      box-shadow: var(--card-shadow);
      margin: 0 auto 16px;
      text-align: center;
    }

    .game-list {
      max-width: 800px;
      width: 100%;
    }

    .game-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: var(--card-shadow);
      transition: box-shadow 0.3s, transform 0.2s;
      display: grid;
      grid-template-columns: 80px 1fr;
      gap: 20px;
      align-items: start;
      box-sizing: border-box;
    }

    .game-card:hover {
      box-shadow: var(--card-hover-shadow);
      transform: translateY(-2px);
    }

    .game-card img {
      width: 80px;
      height: 80px;
      max-width: 100%;
      object-fit: cover;
      border-radius: 8px;
      background: var(--border-color);
      box-sizing: border-box;
    }

    .game-card .content {
      flex: 1;
      overflow: hidden;
    }

    .game-card h3 {
      margin: 0 0 10px;
      font-size: 18px;
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .game-card p {
      margin: 0 0 8px;
      font-size: 13px;
      line-height: 1.5;
      color: var(--secondary-text);
      overflow-wrap: break-word;
    }

    .game-card .actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 12px;
    }

    .game-card button {
      width: auto;
      padding: 8px 14px;
      font-size: 13px;
      border-radius: 6px;
    }

    .game-card button:nth-of-type(1) {
      background: var(--edit-btn-bg);
    }

    .game-card button:nth-of-type(1):hover {
      background: var(--edit-btn-hover);
    }

    .game-card button:nth-of-type(2) {
      background: var(--remove-btn-bg);
    }

    .game-card button:nth-of-type(2):hover {
      background: var(--remove-btn-hover);
    }

    .game-card button:nth-of-type(3),
    .game-card button:nth-of-type(4) {
      background: var(--move-btn-bg);
    }

    .game-card button:nth-of-type(3):hover,
    .game-card button:nth-of-type(4):hover {
      background: var(--move-btn-hover);
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 48px;
      height: 24px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--border-color);
      transition: 0.3s;
      border-radius: 24px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background: white;
      transition: 0.3s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background: var(--input-focus);
    }

    input:checked + .slider:before {
      transform: translateX(24px);
    }

    .switch-label {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--secondary-text);
    }

    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .pagination button {
      width: auto;
      padding: 8px 12px;
      font-size: 13px;
      background: var(--button-bg);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .pagination button:hover {
      background: var(--button-hover);
    }

    .pagination button:disabled {
      background: var(--clear-btn-bg);
      cursor: not-allowed;
    }

    .pagination button.active {
      background: var(--pagination-active-bg);
    }

    .pagination button.active:hover {
      background: var(--pagination-active-hover);
    }

    .search-container {
      max-width: 800px;
      width: 100%;
      margin-bottom: 16px;
    }

    #searchInput {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 14px;
      background: var(--container-bg);
      color: var(--text-color);
      transition: border-color 0.3s;
    }

    #searchInput:focus {
      border-color: var(--input-focus);
      outline: none;
    }

    @media (max-width: 600px) {
      body {
        padding: 12px;
      }
      .container {
        padding: 16px;
      }
      .game-card {
        grid-template-columns: 1fr;
        padding: 16px;
      }
      .game-card img {
        width: 100%;
        height: auto;
        max-height: 120px;
        max-width: 100%;
        object-fit: cover;
        border-radius: 8px;
        margin-bottom: 12px;
      }
      .game-card .content {
        width: 100%;
      }
      .pagination button {
        padding: 6px 10px;
        font-size: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Game Admin Panel</h1>
      <div class="switch-label">
        <label for="darkModeToggle">Dark Mode</label>
        <label class="switch">
          <input type="checkbox" id="darkModeToggle" />
          <span class="slider"></span>
        </label>
      </div>
    </div>
    <div class="form-group">
      <label for="logoUrl">Game Logo URL</label>
      <input type="text" id="logoUrl" placeholder="https://..." />
    </div>
    <div class="form-group">
      <label for="coverUrl">Game Cover URL</label>
      <input type="text" id="coverUrl" placeholder="https://..." />
    </div>
    <div class="form-group">
      <label for="screenshots">Screenshots (comma-separated URLs)</label>
      <input type="text" id="screenshots" placeholder="Url1,Url2,Url3..." />
    </div>
    <div class="form-group">
      <label for="name">Game Name</label>
      <input type="text" id="name" />
    </div>
    <div class="form-group">
      <label for="version">Game Version</label>
      <input type="text" id="version" />
    </div>
    <div class="form-group">
      <label for="description">Game Description</label>
      <textarea id="description" rows="4"></textarea>
    </div>
    <div class="form-group">
      <label for="downloads">Game Downloads</label>
      <input type="number" id="downloads" />
    </div>
    <div class="form-group">
      <label for="rate">Game Rate</label>
      <input type="number" id="rate" step="0.1" max="5" min="0" />
    </div>
    <div class="form-group">
      <label for="lockerLink">Game Locker Link</label>
      <input type="text" id="lockerLink" placeholder="https://..." />
    </div>
    <div class="form-group">
      <label for="modFeatures">Game Mod Features</label>
      <textarea id="modFeatures" rows="3"></textarea>
    </div>
    <div class="form-group">
      <label for="updateDate">Update Date</label>
      <input type="text" id="updateDate" placeholder="Apr 02, 2025" />
    </div>
    <div class="form-group">
      <label for="size">Game Size (e.g. 150MB)</label>
      <input type="text" id="size" />
    </div>
    <div class="form-group">
      <label for="androidLink">Android Link</label>
      <input type="text" id="androidLink" placeholder="https://..." />
    </div>
    <div class="form-group">
      <label for="iosLink">iOS Link</label>
      <input type="text" id="iosLink" placeholder="https://..." />
    </div>
    <div class="form-group switch-label">
      <label for="appleStoreVisible">Show in Apple Store</label>
      <label class="switch">
        <input type="checkbox" id="appleStoreVisible" />
        <span class="slider"></span>
      </label>
    </div>
    <div class="form-group switch-label">
      <label for="isFeatured">Featured</label>
      <label class="switch">
        <input type="checkbox" id="isFeatured" />
        <span class="slider"></span>
      </label>
    </div>
    <div class="button-row">
      <button id="addGameBtn">Add Game</button>
      <button id="clearBtn">Clear</button>
    </div>
    <div class="file-upload">
      <input type="file" id="uploadJson" accept=".json" />
      <label for="uploadJson">Upload JSON</label>
      <span id="fileName">No file selected</span>
    </div>
    <button id="uploadInternetBtn">Upload from Internet</button>
    <button id="downloadBtn">Download JSON</button>
    <button id="copyBtn">Copy JSON to Clipboard</button>
  </div>
  <div class="search-container">
    <input type="text" id="searchInput" placeholder="Search games by title..." />
  </div>
  <h2 id="gameCount" style="margin-bottom: 12px;"></h2>
  <div class="game-list" id="gameList"></div>
  <div class="pagination" id="pagination"></div>
  <script>
    let games = JSON.parse(localStorage.getItem("games")) || [];
    let editIndex = null;
    let currentPage = 1;
    const gamesPerPage = 10;
    let searchQuery = "";

    const fields = [
      "logoUrl",
      "coverUrl",
      "screenshots",
      "name",
      "version",
      "description",
      "downloads",
      "rate",
      "lockerLink",
      "modFeatures",
      "updateDate",
      "size",
      "androidLink",
      "iosLink",
      "appleStoreVisible",
      "isFeatured"
    ];

    // Dark Mode Toggle
    const darkModeToggle = document.getElementById("darkModeToggle");
    const applyTheme = (theme) => {
      document.documentElement.setAttribute("data-theme", theme);
      localStorage.setItem("theme", theme);
      darkModeToggle.checked = theme === "dark";
    };

    const savedTheme = localStorage.getItem("theme") || "light";
    applyTheme(savedTheme);

    darkModeToggle.addEventListener("change", () => {
      applyTheme(darkModeToggle.checked ? "dark" : "light");
    });

    const addGameBtn = document.getElementById("addGameBtn");
    const iosLinkInput = document.getElementById("iosLink");
    const appleStoreSwitch = document.getElementById("appleStoreVisible");

    const toggleIosLink = () => {
      iosLinkInput.disabled = !appleStoreSwitch.checked;
      iosLinkInput.style.background = iosLinkInput.disabled ? 'var(--border-color)' : 'var(--container-bg)';
    };

    toggleIosLink();
    appleStoreSwitch.addEventListener("change", toggleIosLink);

    const clearFields = () => {
      fields.forEach(id => {
        const el = document.getElementById(id);
        if (id === "appleStoreVisible" || id === "isFeatured") {
          el.checked = false;
        } else {
          el.value = "";
        }
      });
      toggleIosLink();
      editIndex = null;
      addGameBtn.textContent = "Add Game";
    };

    document.getElementById("clearBtn").addEventListener("click", clearFields);

    document.getElementById("uploadJson").addEventListener("change", function() {
      const fileNameSpan = document.getElementById("fileName");
      fileNameSpan.textContent = this.files.length ? this.files[0].name : "No file selected";
      const file = this.files[0];
      if (file) uploadJSON(file);
    });

    const getFieldValues = () => {
      const data = {};
      for (let id of fields) {
        const el = document.getElementById(id);
        if (id === "appleStoreVisible" || id === "isFeatured") {
          data[id] = el.checked;
        } else if (id === "iosLink" && !appleStoreSwitch.checked) {
          data[id] = el.value.trim();
        } else if (id === "screenshots") {
          data[id] = el.value.trim() ? el.value.trim().split(",").map(url => url.trim()) : [];
        } else {
          if (!el.value.trim()) {
            el.style.borderColor = "red";
            return null;
          }
          el.style.borderColor = "var(--border-color)";
          data[id] = el.value.trim();
        }
      }
      return data;
    };

    const renderGames = () => {
      const filteredGames = games.filter(game =>
        game.name.toLowerCase().includes(searchQuery.toLowerCase())
      );

      document.getElementById("gameCount").textContent = `Total Games: ${filteredGames.length}`;
      const list = document.getElementById("gameList");
      list.innerHTML = "";

      const startIndex = (currentPage - 1) * gamesPerPage;
      const endIndex = Math.min(startIndex + gamesPerPage, filteredGames.length);
      const paginatedGames = filteredGames.slice(startIndex, endIndex);

      paginatedGames.forEach((game, i) => {
        const globalIndex = games.indexOf(game);
        const card = document.createElement("div");
        card.className = "game-card";

        const truncatedDescription = game.description.length > 130 
          ? game.description.substring(0, 130) + "..." 
          : game.description;
        const truncatedLogoUrl = game.logoUrl && game.logoUrl.length > 100 
          ? game.logoUrl.substring(0, 100) + "..." 
          : game.logoUrl || "N/A";
        const truncatedCoverUrl = game.coverUrl && game.coverUrl.length > 100 
          ? game.coverUrl.substring(0, 100) + "..." 
          : game.coverUrl || "N/A";
        const truncatedAndroidLink = game.androidLink && game.androidLink.length > 100 
          ? game.androidLink.substring(0, 100) + "..." 
          : game.androidLink || "N/A";
        const truncatedIosLink = game.iosLink && game.iosLink.length > 100 
          ? game.iosLink.substring(0, 100) + "..." 
          : game.iosLink || "N/A";

        card.innerHTML = `
          ${game.logoUrl ? `<img src="${game.logoUrl}" alt="${game.name} logo" onerror="this.style.display='none';">` : ''}
          <div class="content">
            <h3>${game.name} (${game.version})</h3>
            <p>${truncatedDescription}</p>
            <p><strong>Logo URL:</strong> ${truncatedLogoUrl}</p>
            <p><strong>Cover URL:</strong> ${truncatedCoverUrl}</p>
            <p><strong>Android Link:</strong> ${truncatedAndroidLink}</p>
            <p><strong>iOS Link:</strong> ${game.appleStoreVisible ? truncatedIosLink : "Not shown in Apple Store"}</p>
            <p><strong>Featured:</strong> ${game.isFeatured ? "Yes" : "No"}</p>
            <div class="actions">
              <button onclick="editGame(${globalIndex})">Edit</button>
              <button onclick="removeGame(${globalIndex})">Remove</button>
              <button onclick="moveUp(${globalIndex})">↑ Up</button>
              <button onclick="moveDown(${globalIndex})">↓ Down</button>
            </div>
          </div>
        `;
        list.appendChild(card);
      });

      renderPagination(filteredGames);
    };

    const renderPagination = (filteredGames) => {
      const pagination = document.getElementById("pagination");
      pagination.innerHTML = "";
      const totalPages = Math.ceil(filteredGames.length / gamesPerPage);

      if (totalPages <= 1) return;

      const prevButton = document.createElement("button");
      prevButton.textContent = "Previous";
      prevButton.disabled = currentPage === 1;
      prevButton.addEventListener("click", () => {
        if (currentPage > 1) {
          currentPage--;
          renderGames();
        }
      });
      pagination.appendChild(prevButton);

      for (let i = 1; i <= totalPages; i++) {
        const pageButton = document.createElement("button");
        pageButton.textContent = i;
        pageButton.className = i === currentPage ? "active" : "";
        pageButton.addEventListener("click", () => {
          currentPage = i;
          renderGames();
        });
        pagination.appendChild(pageButton);
      }

      const nextButton = document.createElement("button");
      nextButton.textContent = "Next";
      nextButton.disabled = currentPage === totalPages;
      nextButton.addEventListener("click", () => {
        if (currentPage < totalPages) {
          currentPage++;
          renderGames();
        }
      });
      pagination.appendChild(nextButton);
    };

    window.moveUp = function(index) {
      if (index > 0) {
        [games[index], games[index - 1]] = [games[index - 1], games[index]];
        saveToLocalStorage();
        renderGames();
      }
    };

    window.moveDown = function(index) {
      if (index < games.length - 1) {
        [games[index], games[index + 1]] = [games[index + 1], games[index]];
        saveToLocalStorage();
        renderGames();
      }
    };

    window.editGame = function(index) {
      const game = games[index];
      fields.forEach(id => {
        const el = document.getElementById(id);
        if (id === "appleStoreVisible" || id === "isFeatured") {
          el.checked = game[id] || false;
        } else if (id === "screenshots") {
          el.value = game[id] ? game[id].join(", ") : "";
        } else {
          el.value = game[id] || "";
        }
      });
      toggleIosLink();
      editIndex = index;
      addGameBtn.textContent = "Edit Game";
      document.getElementById("logoUrl").scrollIntoView({ behavior: "smooth" });
    };

    window.removeGame = function(index) {
      games.splice(index, 1);
      const filteredGames = games.filter(game =>
        game.name.toLowerCase().includes(searchQuery.toLowerCase())
      );
      const totalPages = Math.ceil(filteredGames.length / gamesPerPage);
      if (currentPage > totalPages && totalPages > 0) {
        currentPage = totalPages;
      } else if (filteredGames.length === 0) {
        currentPage = 1;
      }
      renderGames();
      saveToLocalStorage();
    };

    const saveToLocalStorage = () => {
      localStorage.setItem("games", JSON.stringify(games));
    };

    const downloadJSON = () => {
      if (!games.length) {
        alert("No data to download.");
        return;
      }
      const blob = new Blob([JSON.stringify(games, null, 2)], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'games.json';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    };

    const uploadJSON = (file) => {
      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const result = JSON.parse(event.target.result);
          if (Array.isArray(result)) {
            games = result.map(game => ({
              ...game,
              id: game.id || Date.now() + Math.random(),
              logoUrl: game.logoUrl || "",
              coverUrl: game.coverUrl || "",
              screenshots: game.screenshots || [],
              androidLink: game.androidLink || "",
              iosLink: game.iosLink || "",
              appleStoreVisible: game.appleStoreVisible !== undefined ? game.appleStoreVisible : false,
              isFeatured: game.isFeatured !== undefined ? game.isFeatured : false
            }));
            currentPage = 1;
            saveToLocalStorage();
            renderGames();
            toggleIosLink();
            alert("Games loaded successfully.");
          } else {
            alert("Invalid JSON structure.");
          }
        } catch (e) {
          alert("Error parsing JSON.");
        }
      };
      reader.readAsText(file);
    };

    const uploadFromInternet = async () => {
      try {
        const response = await fetch("https://api.jsonbin.io/v3/b/68234c858561e97a50131282", {
          headers: {
            "X-Access-Key": "$2a$10$gSgfYlP3hTZUvhD66Vr0ReHzaQdcR/c0oi9rzQeM7/xDQb0pYfen2"
          }
        });
        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
        const data = await response.json();
        const result = data.record;
        if (Array.isArray(result)) {
          games = result.map(game => ({
            ...game,
            id: game.id || Date.now() + Math.random(),
            logoUrl: game.logoUrl || "",
            coverUrl: game.coverUrl || "",
            screenshots: game.screenshots || [],
            androidLink: game.androidLink || "",
            iosLink: game.iosLink || "",
            appleStoreVisible: game.appleStoreVisible !== undefined ? game.appleStoreVisible : false,
            isFeatured: game.isFeatured !== undefined ? game.isFeatured : false
          }));
          currentPage = 1;
          saveToLocalStorage();
          renderGames();
          toggleIosLink();
          alert("Games loaded successfully from the internet.");
        } else {
          alert("Invalid JSON structure from the internet.");
        }
      } catch (error) {
        alert("Error fetching or parsing JSON from the internet.");
        console.error(error);
      }
    };

    addGameBtn.addEventListener("click", () => {
      const game = getFieldValues();
      if (!game) return alert("Please fill out all required fields.");

      if (editIndex !== null) {
        game.id = games[editIndex].id;
        games[editIndex] = game;
        editIndex = null;
        addGameBtn.textContent = "Add Game";
        alert("Game edited successfully!");
      } else {
        game.id = Date.now();
        games.push(game);
        alert("Game added successfully!");
        const filteredGames = games.filter(game =>
          game.name.toLowerCase().includes(searchQuery.toLowerCase())
        );
        currentPage = Math.ceil(filteredGames.length / gamesPerPage);
      }
      renderGames();
      saveToLocalStorage();
      clearFields();
    });

    document.getElementById("downloadBtn").addEventListener("click", downloadJSON);

    document.getElementById("uploadJson").addEventListener("change", function() {
      const file = this.files[0];
      if (file) uploadJSON(file);
    });

    document.getElementById("uploadInternetBtn").addEventListener("click", uploadFromInternet);

    document.getElementById("copyBtn").addEventListener("click", () => {
      if (!games.length) {
        alert("No games to copy.");
        return;
      }
      const jsonStr = JSON.stringify(games, null, 2);
      navigator.clipboard.writeText(jsonStr).then(() => {
        alert("JSON copied to clipboard!");
      }).catch(err => {
        alert("Failed to copy JSON.");
        console.error(err);
      });
    });

    document.getElementById("searchInput").addEventListener("input", function() {
      searchQuery = this.value.trim();
      currentPage = 1;
      renderGames();
    });

    renderGames();
  </script>
</body>
</html>